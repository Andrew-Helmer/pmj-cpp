# Progressive Multi-Jittered Sample Sequences

This is a C++ implementation of Progressive Multi-Jittered Sample Sequences (in 2D), based off two papers:

* [Progressive Multi-Jittered Sample Sequences (2018)](https://graphics.pixar.com/library/ProgressiveMultiJitteredSampling/paper.pdf) by Christensen, Kensler, and Kilpatrick
* [Efficient Generation of Points that Satisfy
Two-Dimensional Elementary Intervals (2019)](http://jcgt.org/published/0008/01/04/) by Matt Pharr

Much thanks to Per Christensen and Matt Pharr for help and encouragement with this implementation. 

For a Rust version, see [Simon Brown's implementation](https://github.com/sjb3d/pmj). Simon had a key insight on how to optimally pick subquadrants during sample generation, which improved the quality of the sequences generated by this code.

These sample sequences are really great for certain types of Monte Carlo integration problems, especially for use in computer graphics rendering. Here's one such sequence, with a subdividing grid to illustrate the most basic progressive stratification.

<p align="center">
<img src='https://github.com/Andrew-Helmer/pmj-cpp/blob/master/docs/pmj02bn.gif'><br>
<sup><a href="https://colab.research.google.com/github/Andrew-Helmer/pmj-cpp/blob/master/analyses/PMJ_Visualizations.ipynb">Generated with this Colab notebook</a></sup>
</p>

## Using the Sample Sequences for Rendering

See the [Sample Usage Documentation](docs/sample_usage.md). Also provided are some precomputed sample sequences in the [sample_sequences directory](/sample_sequences), so you don't even need to run any of this code.

## Using the Code (Building and Generating Your Own Samples)

See the [Code Usage Documentation](docs/code_usage.md).

## Sequence Properties and Convergence

The PMJ(0,2) or pmj02 sample sequence has the property that any prefix of the samples are stratified on every elementary (0,2) interval.

<p align="center">
<img src='https://github.com/Andrew-Helmer/pmj-cpp/blob/master/docs/pmj02_intervals.svg'>
</p>

This yields extremely good convergence on test integrals, especially at powers of two for the PMJ(0,2) sequence. Note that both uniform random sampling, also known as "jittered" sampling, and [best-candidate sampling](http://www.pbr-book.org/3ed-2018/Sampling_and_Reconstruction/Maximized_Minimal_Distance_Sampler.html) converge at a rate of approximately N<sup>-.5</sup>. Refer to Christensen et al. for comparison against more sample sequences.

<p align="center">
  <img src='https://github.com/Andrew-Helmer/pmj-cpp/blob/master/docs/error_analysis.svg'><br>
  <sup><a href="https://github.com/Andrew-Helmer/pmj-cpp/blob/master/analyses/PMJ(0%2C2)_Error_Analysis.ipynb">Generated with this Colab/Jupyter notebook</a></sup>
</p>

The Progressive Multi-Jittered Sequence with Blue Noise, or pmjbn, doesn't have as good convergence as pmj02, but it does have very nice blue noise properties, while still having better convergence than best-candidate sampling. This animation shows how the samples are (mostly) distributed far away from each other at any given number of samples.

<p align="center">
<img src='https://github.com/Andrew-Helmer/pmj-cpp/blob/master/docs/pmjbn.gif'>
</p>

## Licensing

See the [LICENSE](/LICENSE).
